{"version":3,"sources":["ng://primeng/toast/toast.ts"],"names":["ToastItem","zone","this","onClose","EventEmitter","prototype","ngAfterViewInit","initTimeout","_this","message","sticky","runOutsideAngular","timeout","setTimeout","emit","index","life","clearTimeout","onMouseEnter","onMouseLeave","onCloseIconClick","event","preventDefault","ngOnDestroy","NgZone","__decorate","Input","Output","ViewChild","Component","selector","template","animations","trigger","state","style","transform","opacity","transition","animate","height","Toast","messageService","cd","autoZIndex","baseZIndex","position","preventOpenDuplicates","preventDuplicates","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","ngOnInit","messageSubscription","messageObserver","subscribe","messages","Array","filteredMessages","filter","m","canAdd","add","modal","length","enableModality","clearSubscription","clearObserver","key","disableModality","__spread","messagesArchieve","allow","containsMessage","collection","find","summary","detail","severity","ngAfterContentInit","templates","forEach","item","getType","onMessageClose","splice","detectChanges","mask","document","createElement","zIndex","String","parseInt","containerViewChild","nativeElement","display","DomHandler","addMultipleClasses","body","appendChild","removeChild","onAnimationStart","fromState","zindex","unsubscribe","MessageService","ChangeDetectorRef","ContentChildren","PrimeTemplate","query","animateChild","changeDetection","ChangeDetectionStrategy","Default","ToastModule","NgModule","imports","CommonModule","exports","SharedModule","declarations"],"mappings":"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","sourcesContent":["import {NgModule,Component,Input,Output,OnInit,AfterViewInit,AfterContentInit,OnDestroy,ElementRef,ViewChild,EventEmitter,ContentChildren,QueryList,TemplateRef,ChangeDetectionStrategy, NgZone, ChangeDetectorRef} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {Message} from 'primeng/api';\r\nimport {DomHandler} from 'primeng/dom';\r\nimport {PrimeTemplate,SharedModule} from 'primeng/api';\r\nimport {MessageService} from 'primeng/api';\r\nimport {Subscription} from 'rxjs';\r\nimport {trigger,state,style,transition,animate,query,animateChild,AnimationEvent} from '@angular/animations';\r\n\r\n@Component({\r\n    selector: 'p-toastItem',\r\n    template: `\r\n        <div #container [attr.id]=\"message.id\" class=\"ui-toast-message ui-shadow\" [@messageState]=\"{value: 'visible', params: {showTransformParams: showTransformOptions, hideTransformParams: hideTransformOptions, showTransitionParams: showTransitionOptions, hideTransitionParams: hideTransitionOptions}}\"\r\n            [ngClass]=\"{'ui-toast-message-info': message.severity == 'info','ui-toast-message-warn': message.severity == 'warn',\r\n                'ui-toast-message-error': message.severity == 'error','ui-toast-message-success': message.severity == 'success'}\"\r\n                (mouseenter)=\"onMouseEnter()\" (mouseleave)=\"onMouseLeave()\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\">\r\n            <div class=\"ui-toast-message-content\">\r\n                <a tabindex=\"0\" class=\"ui-toast-close-icon pi pi-times\" (click)=\"onCloseIconClick($event)\" (keydown.enter)=\"onCloseIconClick($event)\" *ngIf=\"message.closable !== false\"></a>\r\n                <ng-container *ngIf=\"!template\">\r\n                    <span class=\"ui-toast-icon pi\"\r\n                        [ngClass]=\"{'pi-info-circle': message.severity == 'info', 'pi-exclamation-triangle': message.severity == 'warn',\r\n                            'pi-times-circle': message.severity == 'error', 'pi-check' :message.severity == 'success'}\"></span>\r\n                    <div class=\"ui-toast-message-text-content\">\r\n                        <div class=\"ui-toast-summary\">{{message.summary}}</div>\r\n                        <div class=\"ui-toast-detail\">{{message.detail}}</div>\r\n                    </div>\r\n                </ng-container>\r\n                <ng-container *ngTemplateOutlet=\"template; context: {$implicit: message}\"></ng-container>\r\n            </div>\r\n        </div>\r\n    `,\r\n    animations: [\r\n        trigger('messageState', [\r\n            state('visible', style({\r\n                transform: 'translateY(0)',\r\n                opacity: 1\r\n            })),\r\n            transition('void => *', [\r\n                style({transform: '{{showTransformParams}}', opacity: 0}),\r\n                animate('{{showTransitionParams}}')\r\n            ]),\r\n            transition('* => void', [\r\n                animate(('{{hideTransitionParams}}'), style({\r\n                    height: 0,\r\n                    opacity: 0,\r\n                    transform: '{{hideTransformParams}}'\r\n                }))\r\n            ])\r\n        ])\r\n    ]\r\n})\r\nexport class ToastItem implements AfterViewInit, OnDestroy {\r\n\r\n    @Input() message: Message;\r\n\r\n    @Input() index: number;\r\n\r\n    @Input() template: TemplateRef<any>;\r\n\r\n    @Input() showTransformOptions: string;\r\n\r\n    @Input() hideTransformOptions: string;\r\n\r\n    @Input() showTransitionOptions: string;\r\n\r\n    @Input() hideTransitionOptions: string;\r\n\r\n    @Output() onClose: EventEmitter<any> = new EventEmitter();\r\n\r\n    @ViewChild('container') containerViewChild: ElementRef;\r\n\r\n    timeout: any;\r\n\r\n    constructor(private zone: NgZone) {}\r\n    \r\n    ngAfterViewInit() {\r\n        this.initTimeout();\r\n    }\r\n\r\n    initTimeout() {\r\n        if (!this.message.sticky) {\r\n            this.zone.runOutsideAngular(() => {\r\n                this.timeout = setTimeout(() => {\r\n                    this.onClose.emit({\r\n                        index: this.index,\r\n                        message: this.message\r\n                    });\r\n                }, this.message.life || 3000);\r\n            });\r\n        }\r\n    }\r\n\r\n    clearTimeout() {\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = null;\r\n        }\r\n    }\r\n    \r\n    onMouseEnter() {\r\n        this.clearTimeout();\r\n    }\r\n\r\n    onMouseLeave() {\r\n        this.initTimeout();\r\n    }\r\n \r\n    onCloseIconClick(event) {\r\n        this.clearTimeout();\r\n        \r\n        this.onClose.emit({\r\n            index: this.index,\r\n            message: this.message\r\n        });\r\n\r\n        event.preventDefault();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.clearTimeout();\r\n    }\r\n}\r\n\r\n@Component({\r\n    selector: 'p-toast',\r\n    template: `\r\n        <div #container [ngClass]=\"{'ui-toast ui-widget': true, \r\n                'ui-toast-top-right': position === 'top-right',\r\n                'ui-toast-top-left': position === 'top-left',\r\n                'ui-toast-bottom-right': position === 'bottom-right',\r\n                'ui-toast-bottom-left': position === 'bottom-left',\r\n                'ui-toast-top-center': position === 'top-center',\r\n                'ui-toast-bottom-center': position === 'bottom-center',\r\n                'ui-toast-center': position === 'center'}\" \r\n                [ngStyle]=\"style\" [class]=\"styleClass\">\r\n            <p-toastItem *ngFor=\"let msg of messages; let i=index\" [message]=\"msg\" [index]=\"i\" (onClose)=\"onMessageClose($event)\"\r\n                    [template]=\"template\" @toastAnimation (@toastAnimation.start)=\"onAnimationStart($event)\" \r\n                    [showTransformOptions]=\"showTransformOptions\" [hideTransformOptions]=\"hideTransformOptions\" \r\n                    [showTransitionOptions]=\"showTransitionOptions\" [hideTransitionOptions]=\"hideTransitionOptions\"></p-toastItem>\r\n        </div>\r\n    `,\r\n    animations: [\r\n        trigger('toastAnimation', [\r\n            transition(':enter, :leave', [\r\n                query('@*', animateChild())\r\n            ])\r\n        ])\r\n    ],\r\n    changeDetection: ChangeDetectionStrategy.Default\r\n})\r\nexport class Toast implements OnInit,AfterContentInit,OnDestroy {\r\n\r\n    @Input() key: string;\r\n\r\n    @Input() autoZIndex: boolean = true;\r\n    \r\n    @Input() baseZIndex: number = 0;\r\n\r\n    @Input() style: any;\r\n        \r\n    @Input() styleClass: string;\r\n\r\n    @Input() position: string = 'top-right';\r\n\r\n    @Input() modal: boolean;\r\n\r\n    @Input() preventOpenDuplicates: boolean = false;\r\n\r\n    @Input() preventDuplicates: boolean = false;\r\n    \r\n    @Input() showTransformOptions: string = 'translateY(100%)';\r\n\r\n    @Input() hideTransformOptions: string = 'translateY(-100%)';\r\n\r\n    @Input() showTransitionOptions: string = '300ms ease-out';\r\n\r\n    @Input() hideTransitionOptions: string = '250ms ease-in';\r\n\r\n    @Output() onClose: EventEmitter<any> = new EventEmitter();\r\n\r\n    @ViewChild('container') containerViewChild: ElementRef;\r\n\r\n    @ContentChildren(PrimeTemplate) templates: QueryList<any>;\r\n\r\n    messageSubscription: Subscription;\r\n\r\n    clearSubscription: Subscription;\r\n\r\n    messages: Message[];\r\n\r\n    messagesArchieve: Message[];\r\n\r\n    template: TemplateRef<any>;\r\n\r\n    mask: HTMLDivElement;\r\n    \r\n    constructor(public messageService: MessageService, private cd: ChangeDetectorRef) {}\r\n\r\n    ngOnInit() {\r\n        this.messageSubscription = this.messageService.messageObserver.subscribe(messages => {\r\n            if (messages) {\r\n                if (messages instanceof Array) {\r\n                    const filteredMessages = messages.filter(m => this.canAdd(m));\r\n                    this.add(filteredMessages);\r\n                }\r\n                else if (this.canAdd(messages)) {\r\n                    this.add([messages]);\r\n                }\r\n\r\n                if (this.modal && this.messages && this.messages.length) {\r\n                    this.enableModality();\r\n                }\r\n            }\r\n        });\r\n\r\n        this.clearSubscription = this.messageService.clearObserver.subscribe(key => {\r\n            if (key) {\r\n                if (this.key === key) {\r\n                    this.messages = null;\r\n                }\r\n            }\r\n            else {\r\n                this.messages = null;\r\n            }\r\n\r\n            if (this.modal) {\r\n                this.disableModality();\r\n            }\r\n        });       \r\n    }\r\n\r\n    add(messages: Message[]): void {\r\n        this.messages = this.messages ? [...this.messages, ...messages] : [...messages];\r\n\r\n        if (this.preventDuplicates) {\r\n            this.messagesArchieve = this.messagesArchieve ? [...this.messagesArchieve, ...messages] : [...messages];\r\n        }\r\n    }\r\n\r\n    canAdd(message: Message): boolean {\r\n        let allow = this.key === message.key;\r\n\r\n        if (allow && this.preventOpenDuplicates) {\r\n            allow = !this.containsMessage(this.messages, message);\r\n        }\r\n\r\n        if (allow && this.preventDuplicates) {\r\n            allow = !this.containsMessage(this.messagesArchieve, message);\r\n        }\r\n\r\n        return allow;\r\n    }\r\n\r\n    containsMessage(collection: Message[], message: Message): boolean {\r\n        if (!collection) {\r\n            return false;\r\n        }\r\n\r\n        return collection.find(m => {\r\n           return (m.summary === message.summary && m.detail && message.detail && m.severity === message.severity);\r\n        }) != null;\r\n    }\r\n\r\n    ngAfterContentInit() {\r\n        this.templates.forEach((item) => {\r\n            switch(item.getType()) {\r\n                case 'message':\r\n                    this.template = item.template;\r\n                break;\r\n\r\n                default:\r\n                    this.template = item.template;\r\n                break;\r\n            }\r\n        });\r\n    }\r\n\r\n    onMessageClose(event) {\r\n        this.messages.splice(event.index, 1);\r\n\r\n        if (this.messages.length === 0) {\r\n            this.disableModality();\r\n        }\r\n\r\n        this.onClose.emit({\r\n            message: event.message\r\n        });\r\n\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    enableModality() {\r\n        if (!this.mask) {\r\n            this.mask = document.createElement('div');\r\n            this.mask.style.zIndex = String(parseInt(this.containerViewChild.nativeElement.style.zIndex) - 1);\r\n            this.mask.style.display = 'block';\r\n            let maskStyleClass = 'ui-widget-overlay ui-dialog-mask';\r\n            DomHandler.addMultipleClasses(this.mask, maskStyleClass);\r\n            document.body.appendChild(this.mask);\r\n        }\r\n    }\r\n    \r\n    disableModality() {\r\n        if (this.mask) {\r\n            document.body.removeChild(this.mask);\r\n            this.mask = null;\r\n        }\r\n    }\r\n\r\n    onAnimationStart(event: AnimationEvent) {\r\n        if (event.fromState === 'void' && this.autoZIndex) {\r\n            this.containerViewChild.nativeElement.style.zIndex = String(this.baseZIndex + (++DomHandler.zindex));\r\n        }\r\n    }\r\n\r\n    ngOnDestroy() {        \r\n        if (this.messageSubscription) {\r\n            this.messageSubscription.unsubscribe();\r\n        }\r\n        \r\n        if (this.clearSubscription) {\r\n            this.clearSubscription.unsubscribe();\r\n        }\r\n\r\n        this.disableModality();\r\n    }\r\n}\r\n\r\n@NgModule({\r\n    imports: [CommonModule],\r\n    exports: [Toast,SharedModule],\r\n    declarations: [Toast,ToastItem]\r\n})\r\nexport class ToastModule { }\r\n"]}