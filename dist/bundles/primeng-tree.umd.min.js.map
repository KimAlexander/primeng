{"version":3,"sources":["ng://primeng/tree/tree.ts"],"names":["UITreeNode","tree","this","prototype","ngOnInit","node","parent","parentNode","syncNodeOption","value","getNodeWithKey","key","getIcon","icon","expanded","children","length","expandedIcon","collapsedIcon","UITreeNode_1","ICON_CLASS","isLeaf","isNodeLeaf","toggle","event","collapse","expand","onNodeExpand","emit","originalEvent","onNodeCollapse","onNodeClick","onNodeKeydown","which","onNodeTouchEnd","onNodeRightClick","isSelected","onDropPoint","position","_this","preventDefault","dragNode","dragNodeIndex","dragNodeScope","isValidDropPointIndex","dragNodeTree","index","allowDrop","validateDrop","onNodeDrop","dropNode","dropIndex","accept","processPointDrop","draghoverPrev","draghoverNext","newNodeList","dragNodeSubNodes","splice","push","dragDropService","stopDrag","subNodes","onDropPointDragOver","dataTransfer","dropEffect","onDropPointDragEnter","onDropPointDragLeave","onDragStart","draggableNodes","draggable","setData","startDrag","scope","draggableScope","onDragStop","onDropNodeDragOver","droppableNodes","stopPropagation","onDropNode","droppable","dragNode_1","processNodeDrop","draghoverNode","onDropNodeDragEnter","onDropNodeDragLeave","rect","currentTarget","getBoundingClientRect","x","left","width","y","Math","floor","top","height","onKeyDown","nodeElement","target","parentElement","nodeName","listElement","focusNode","nextNodeElement","nextElementSibling","nextSiblingAncestor","findNextSiblingOfAncestor","previousElementSibling","findLastVisibleDescendant","parentNodeElement","getParentNodeElement","childrenListElement","lastChildElement","tagName","element","focus","Inject","args","forwardRef","Tree","__decorate","Input","Component","selector","template","__param","el","selectionChange","EventEmitter","onNodeSelect","onNodeUnselect","onNodeContextMenuSelect","layout","metaKeySelection","propagateSelectionUp","propagateSelectionDown","loadingIcon","emptyMessage","filterBy","filterMode","nodeTrackBy","item","dragStartSubscription","dragStart$","subscribe","dragStopSubscription","dragStop$","dragHover","Object","defineProperty","ngAfterContentInit","templates","templateMap","forEach","name","eventTarget","DomHandler","hasClass","selectionMode","selectable","hasFilteredNodes","index_1","findIndexInSelection","selected","isCheckboxSelectionMode","propagateDown","selection","filter","val","i","propagateUp","__spread","nodeTouched","metaKey","ctrlKey","isSingleSelectionMode","isMultipleSelectionMode","contextMenu","className","indexOf","show","selectedNode","parentNodes","option","_node","filteredNodes","nodes","nodes_1","__values","nodes_1_1","next","done","matchedNode","select","selectedCount","childPartialSelected","_b","_c","child","partialSelected","index_2","leaf","getRootNode","getTemplateForNode","type","onDragOver","onDrop","onDragEnter","onDragLeave","isValidDragScope","allow","parent_1","dragScope","dropScope","droppableScope","Array","dropScope_1","dropScope_1_1","s","dragScope_1","e_5","dragScope_1_1","onFilter","filterValue","searchFields","split","filterText","ObjectUtils","removeAccents","toLocaleLowerCase","filterLocale","isStrictMode","copyNode","__assign","paramsWithoutNode","findFilteredNodes","isFilterMatched","matched","childNodes","childNodes_1","childNodes_1_1","childNode","copyChildNode","_a","searchFields_1","searchFields_1_1","field","String","resolveFieldData","getBlockableElement","nativeElement","ngOnDestroy","unsubscribe","ElementRef","TreeDragDropService","decorators","Optional","Output","ContentChildren","PrimeTemplate","changeDetection","ChangeDetectionStrategy","Default","TreeModule","NgModule","imports","CommonModule","exports","SharedModule","declarations"],"mappings":"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","sourcesContent":["import {NgModule,Component,Input,AfterContentInit,OnDestroy,Output,EventEmitter,OnInit,\r\n    ContentChildren,QueryList,TemplateRef,Inject,ElementRef,forwardRef,ChangeDetectionStrategy} from '@angular/core';\r\nimport {Optional} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {TreeNode} from 'primeng/api';\r\nimport {SharedModule} from 'primeng/api';\r\nimport {PrimeTemplate} from 'primeng/api';\r\nimport {TreeDragDropService} from 'primeng/api';\r\nimport {Subscription} from 'rxjs';\r\nimport {BlockableUI} from 'primeng/api';\r\nimport {ObjectUtils} from 'primeng/utils';\r\nimport {DomHandler} from 'primeng/dom';\r\n\r\n@Component({\r\n    selector: 'p-treeNode',\r\n    template: `\r\n        <ng-template [ngIf]=\"node\">\r\n            <li *ngIf=\"tree.droppableNodes\" class=\"ui-treenode-droppoint\" [ngClass]=\"{'ui-treenode-droppoint-active ui-state-highlight':draghoverPrev}\"\r\n            (drop)=\"onDropPoint($event,-1)\" (dragover)=\"onDropPointDragOver($event)\" (dragenter)=\"onDropPointDragEnter($event,-1)\" (dragleave)=\"onDropPointDragLeave($event)\"></li>\r\n            <li *ngIf=\"!tree.horizontal\" role=\"treeitem\" [ngClass]=\"['ui-treenode',node.styleClass||'', isLeaf() ? 'ui-treenode-leaf': '']\">\r\n                <div class=\"ui-treenode-content\" (click)=\"onNodeClick($event)\" (contextmenu)=\"onNodeRightClick($event)\" (touchend)=\"onNodeTouchEnd()\"\r\n                    (drop)=\"onDropNode($event)\" (dragover)=\"onDropNodeDragOver($event)\" (dragenter)=\"onDropNodeDragEnter($event)\" (dragleave)=\"onDropNodeDragLeave($event)\"\r\n                    [draggable]=\"tree.draggableNodes\" (dragstart)=\"onDragStart($event)\" (dragend)=\"onDragStop($event)\" [attr.tabindex]=\"0\"\r\n                    [ngClass]=\"{'ui-treenode-selectable':tree.selectionMode && node.selectable !== false,'ui-treenode-dragover':draghoverNode, 'ui-treenode-content-selected':isSelected()}\"\r\n                    (keydown)=\"onKeyDown($event)\" [attr.aria-posinset]=\"this.index + 1\" [attr.aria-expanded]=\"this.node.expanded\" [attr.aria-selected]=\"isSelected()\" [attr.aria-label]=\"node.label\">\r\n                    <span class=\"ui-tree-toggler pi pi-fw ui-unselectable-text\" [ngClass]=\"{'pi-caret-right':!node.expanded,'pi-caret-down':node.expanded}\"\r\n                            (click)=\"toggle($event)\"></span\r\n                    ><div class=\"ui-chkbox\" *ngIf=\"tree.selectionMode == 'checkbox'\" [attr.aria-checked]=\"isSelected()\"><div class=\"ui-chkbox-box ui-widget ui-corner-all ui-state-default\" [ngClass]=\"{'ui-state-disabled': node.selectable === false}\">\r\n                        <span class=\"ui-chkbox-icon ui-clickable pi\"\r\n                            [ngClass]=\"{'pi-check':isSelected(),'pi-minus':node.partialSelected}\"></span></div></div\r\n                    ><span [class]=\"getIcon()\" *ngIf=\"node.icon||node.expandedIcon||node.collapsedIcon\"></span\r\n                    ><span class=\"ui-treenode-label ui-corner-all\"\r\n                        [ngClass]=\"{'ui-state-highlight':isSelected()}\">\r\n                            <span *ngIf=\"!tree.getTemplateForNode(node)\">{{node.label}}</span>\r\n                            <span *ngIf=\"tree.getTemplateForNode(node)\">\r\n                                <ng-container *ngTemplateOutlet=\"tree.getTemplateForNode(node); context: {$implicit: node}\"></ng-container>\r\n                            </span>\r\n                    </span>\r\n                </div>\r\n                <ul class=\"ui-treenode-children\" style=\"display: none;\" *ngIf=\"node.children && node.expanded\" [style.display]=\"node.expanded ? 'block' : 'none'\" role=\"group\">\r\n                    <p-treeNode *ngFor=\"let childNode of node.children;let firstChild=first;let lastChild=last; let index=index; trackBy: tree.nodeTrackBy\" [node]=\"childNode\" [parentNode]=\"node\"\r\n                        [firstChild]=\"firstChild\" [lastChild]=\"lastChild\" [index]=\"index\"></p-treeNode>\r\n                </ul>\r\n            </li>\r\n            <li *ngIf=\"tree.droppableNodes&&lastChild\" class=\"ui-treenode-droppoint\" [ngClass]=\"{'ui-treenode-droppoint-active ui-state-highlight':draghoverNext}\"\r\n            (drop)=\"onDropPoint($event,1)\" (dragover)=\"onDropPointDragOver($event)\" (dragenter)=\"onDropPointDragEnter($event,1)\" (dragleave)=\"onDropPointDragLeave($event)\"></li>\r\n            <table *ngIf=\"tree.horizontal\" [class]=\"node.styleClass\">\r\n                <tbody>\r\n                    <tr>\r\n                        <td class=\"ui-treenode-connector\" *ngIf=\"!root\">\r\n                            <table class=\"ui-treenode-connector-table\">\r\n                                <tbody>\r\n                                    <tr>\r\n                                        <td [ngClass]=\"{'ui-treenode-connector-line':!firstChild}\"></td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <td [ngClass]=\"{'ui-treenode-connector-line':!lastChild}\"></td>\r\n                                    </tr>\r\n                                </tbody>\r\n                            </table>\r\n                        </td>\r\n                        <td class=\"ui-treenode\" [ngClass]=\"{'ui-treenode-collapsed':!node.expanded}\">\r\n                            <div class=\"ui-treenode-content ui-state-default ui-corner-all\" tabindex=\"0\"\r\n                                [ngClass]=\"{'ui-treenode-selectable':tree.selectionMode,'ui-state-highlight':isSelected()}\" (click)=\"onNodeClick($event)\" (contextmenu)=\"onNodeRightClick($event)\"\r\n                                (touchend)=\"onNodeTouchEnd()\" (keydown)=\"onNodeKeydown($event)\">\r\n                                <span class=\"ui-tree-toggler pi pi-fw ui-unselectable-text\" [ngClass]=\"{'pi-plus':!node.expanded,'pi-minus':node.expanded}\" *ngIf=\"!isLeaf()\"\r\n                                        (click)=\"toggle($event)\"></span\r\n                                ><span [class]=\"getIcon()\" *ngIf=\"node.icon||node.expandedIcon||node.collapsedIcon\"></span\r\n                                ><span class=\"ui-treenode-label ui-corner-all\">\r\n                                        <span *ngIf=\"!tree.getTemplateForNode(node)\">{{node.label}}</span>\r\n                                        <span *ngIf=\"tree.getTemplateForNode(node)\">\r\n                                        <ng-container *ngTemplateOutlet=\"tree.getTemplateForNode(node); context: {$implicit: node}\"></ng-container>\r\n                                        </span>\r\n                                </span>\r\n                            </div>\r\n                        </td>\r\n                        <td class=\"ui-treenode-children-container\" *ngIf=\"node.children && node.expanded\" [style.display]=\"node.expanded ? 'table-cell' : 'none'\">\r\n                            <div class=\"ui-treenode-children\">\r\n                                <p-treeNode *ngFor=\"let childNode of node.children;let firstChild=first;let lastChild=last; trackBy: tree.nodeTrackBy\" [node]=\"childNode\"\r\n                                        [firstChild]=\"firstChild\" [lastChild]=\"lastChild\"></p-treeNode>\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </ng-template>\r\n    `\r\n})\r\nexport class UITreeNode implements OnInit {\r\n\r\n    static ICON_CLASS: string = 'ui-treenode-icon ';\r\n\r\n    @Input() node: TreeNode;\r\n\r\n    @Input() parentNode: TreeNode;\r\n\r\n    @Input() root: boolean;\r\n\r\n    @Input() index: number;\r\n\r\n    @Input() firstChild: boolean;\r\n\r\n    @Input() lastChild: boolean;\r\n\r\n    tree: Tree;\r\n\r\n    constructor(@Inject(forwardRef(() => Tree)) tree) {\r\n        this.tree = tree as Tree;\r\n    }\r\n\r\n    draghoverPrev: boolean;\r\n\r\n    draghoverNext: boolean;\r\n\r\n    draghoverNode: boolean\r\n\r\n    ngOnInit() {\r\n        this.node.parent = this.parentNode;\r\n\r\n        if (this.parentNode) {\r\n            this.tree.syncNodeOption(this.node, this.tree.value, 'parent', this.tree.getNodeWithKey(this.parentNode.key, this.tree.value));\r\n        }\r\n    }\r\n\r\n    getIcon() {\r\n        let icon: string;\r\n\r\n        if (this.node.icon)\r\n            icon = this.node.icon;\r\n        else\r\n            icon = this.node.expanded && this.node.children && this.node.children.length ? this.node.expandedIcon : this.node.collapsedIcon;\r\n\r\n        return UITreeNode.ICON_CLASS + ' ' + icon;\r\n    }\r\n\r\n    isLeaf() {\r\n        return this.tree.isNodeLeaf(this.node);\r\n    }\r\n\r\n    toggle(event: Event) {\r\n        if (this.node.expanded)\r\n            this.collapse(event);\r\n        else\r\n            this.expand(event);\r\n    }\r\n\r\n    expand(event: Event) {\r\n        this.node.expanded = true;\r\n        this.tree.onNodeExpand.emit({originalEvent: event, node: this.node});\r\n    }\r\n\r\n    collapse(event: Event) {\r\n        this.node.expanded = false;\r\n        this.tree.onNodeCollapse.emit({originalEvent: event, node: this.node});\r\n    }\r\n\r\n    onNodeClick(event: MouseEvent) {\r\n        this.tree.onNodeClick(event, this.node);\r\n    }\r\n\r\n    onNodeKeydown(event: KeyboardEvent) {\r\n        if (event.which === 13) {\r\n            this.tree.onNodeClick(event, this.node);\r\n        }\r\n    }\r\n\r\n    onNodeTouchEnd() {\r\n        this.tree.onNodeTouchEnd();\r\n    }\r\n\r\n    onNodeRightClick(event: MouseEvent) {\r\n        this.tree.onNodeRightClick(event, this.node);\r\n    }\r\n\r\n    isSelected() {\r\n        return this.tree.isSelected(this.node);\r\n    }\r\n\r\n    onDropPoint(event: Event, position: number) {\r\n        event.preventDefault();\r\n        let dragNode = this.tree.dragNode;\r\n        let dragNodeIndex = this.tree.dragNodeIndex;\r\n        let dragNodeScope = this.tree.dragNodeScope;\r\n        let isValidDropPointIndex = this.tree.dragNodeTree === this.tree ? (position === 1 || dragNodeIndex !== this.index - 1) : true;\r\n\r\n        if (this.tree.allowDrop(dragNode, this.node, dragNodeScope) && isValidDropPointIndex) {\r\n            if (this.tree.validateDrop) {\r\n                this.tree.onNodeDrop.emit({\r\n                    originalEvent: event,\r\n                    dragNode: dragNode,\r\n                    dropNode: this.node,\r\n                    dropIndex: this.index,\r\n                    accept: () => {\r\n                        this.processPointDrop(dragNode, dragNodeIndex, position);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                this.processPointDrop(dragNode, dragNodeIndex, position);\r\n                this.tree.onNodeDrop.emit({\r\n                    originalEvent: event,\r\n                    dragNode: dragNode,\r\n                    dropNode: this.node,\r\n                    dropIndex: this.index\r\n                });\r\n            }\r\n        }\r\n\r\n        this.draghoverPrev = false;\r\n        this.draghoverNext = false;\r\n    }\r\n\r\n    processPointDrop(dragNode, dragNodeIndex, position) {\r\n        let newNodeList = this.node.parent ? this.node.parent.children : this.tree.value;\r\n        this.tree.dragNodeSubNodes.splice(dragNodeIndex, 1);\r\n        let dropIndex = this.index;\r\n\r\n        if (position < 0) {\r\n            dropIndex = (this.tree.dragNodeSubNodes === newNodeList) ? ((this.tree.dragNodeIndex > this.index) ? this.index : this.index - 1) : this.index;\r\n            newNodeList.splice(dropIndex, 0, dragNode);\r\n        }\r\n        else {\r\n            dropIndex = newNodeList.length;\r\n            newNodeList.push(dragNode);\r\n        }\r\n\r\n        this.tree.dragDropService.stopDrag({\r\n            node: dragNode,\r\n            subNodes: this.node.parent ? this.node.parent.children : this.tree.value,\r\n            index: dragNodeIndex\r\n        });\r\n    }\r\n\r\n    onDropPointDragOver(event) {\r\n        event.dataTransfer.dropEffect = 'move';\r\n        event.preventDefault();\r\n    }\r\n\r\n    onDropPointDragEnter(event: Event, position: number) {\r\n        if (this.tree.allowDrop(this.tree.dragNode, this.node, this.tree.dragNodeScope)) {\r\n            if (position < 0)\r\n                this.draghoverPrev = true;\r\n            else\r\n                this.draghoverNext = true;\r\n        }\r\n    }\r\n\r\n    onDropPointDragLeave(event: Event) {\r\n        this.draghoverPrev = false;\r\n        this.draghoverNext = false;\r\n    }\r\n\r\n    onDragStart(event) {\r\n        if (this.tree.draggableNodes && this.node.draggable !== false) {\r\n            event.dataTransfer.setData(\"text\", \"data\");\r\n\r\n            this.tree.dragDropService.startDrag({\r\n                tree: this,\r\n                node: this.node,\r\n                subNodes: this.node.parent ? this.node.parent.children : this.tree.value,\r\n                index: this.index,\r\n                scope: this.tree.draggableScope\r\n            });\r\n        }\r\n        else {\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    onDragStop(event) {\r\n        this.tree.dragDropService.stopDrag({\r\n            node: this.node,\r\n            subNodes: this.node.parent ? this.node.parent.children : this.tree.value,\r\n            index: this.index\r\n        });\r\n    }\r\n\r\n    onDropNodeDragOver(event) {\r\n        event.dataTransfer.dropEffect = 'move';\r\n        if (this.tree.droppableNodes) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        }\r\n    }\r\n\r\n    onDropNode(event) {\r\n        if (this.tree.droppableNodes && this.node.droppable !== false) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            let dragNode = this.tree.dragNode;\r\n            if (this.tree.allowDrop(dragNode, this.node, this.tree.dragNodeScope)) {\r\n                if (this.tree.validateDrop) {\r\n                    this.tree.onNodeDrop.emit({\r\n                        originalEvent: event,\r\n                        dragNode: dragNode,\r\n                        dropNode: this.node,\r\n                        index: this.index,\r\n                        accept: () => {\r\n                            this.processNodeDrop(dragNode);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    this.processNodeDrop(dragNode);\r\n                    this.tree.onNodeDrop.emit({\r\n                        originalEvent: event,\r\n                        dragNode: dragNode,\r\n                        dropNode: this.node,\r\n                        index: this.index\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        this.draghoverNode = false;\r\n    }\r\n\r\n    processNodeDrop(dragNode) {\r\n        let dragNodeIndex = this.tree.dragNodeIndex;\r\n        this.tree.dragNodeSubNodes.splice(dragNodeIndex, 1);\r\n\r\n        if (this.node.children)\r\n            this.node.children.push(dragNode);\r\n        else\r\n            this.node.children = [dragNode];\r\n\r\n        this.tree.dragDropService.stopDrag({\r\n            node: dragNode,\r\n            subNodes: this.node.parent ? this.node.parent.children : this.tree.value,\r\n            index: this.tree.dragNodeIndex\r\n        });\r\n\r\n\r\n    }\r\n\r\n    onDropNodeDragEnter(event) {\r\n        if (this.tree.droppableNodes && this.node.droppable !== false && this.tree.allowDrop(this.tree.dragNode, this.node, this.tree.dragNodeScope)) {\r\n            this.draghoverNode = true;\r\n        }\r\n    }\r\n\r\n    onDropNodeDragLeave(event) {\r\n        if (this.tree.droppableNodes) {\r\n            let rect = event.currentTarget.getBoundingClientRect();\r\n            if (event.x > rect.left + rect.width || event.x < rect.left || event.y >= Math.floor(rect.top + rect.height) || event.y < rect.top) {\r\n               this.draghoverNode = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    onKeyDown(event: KeyboardEvent) {\r\n        const nodeElement = (<HTMLDivElement> event.target).parentElement.parentElement;\r\n\r\n        if (nodeElement.nodeName !== 'P-TREENODE') {\r\n            return;\r\n        }\r\n\r\n        switch (event.which) {\r\n            //down arrow\r\n            case 40:\r\n                const listElement = (this.tree.droppableNodes) ? nodeElement.children[1].children[1] : nodeElement.children[0].children[1];\r\n                if (listElement && listElement.children.length > 0) {\r\n                    this.focusNode(listElement.children[0]);\r\n                }\r\n                else {\r\n                    const nextNodeElement = nodeElement.nextElementSibling;\r\n                    if (nextNodeElement) {\r\n                        this.focusNode(nextNodeElement);\r\n                    }\r\n                    else {\r\n                        let nextSiblingAncestor = this.findNextSiblingOfAncestor(nodeElement);\r\n                        if (nextSiblingAncestor) {\r\n                            this.focusNode(nextSiblingAncestor);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                event.preventDefault();\r\n            break;\r\n\r\n            //up arrow\r\n            case 38:\r\n                if (nodeElement.previousElementSibling) {\r\n                    this.focusNode(this.findLastVisibleDescendant(nodeElement.previousElementSibling));\r\n                }\r\n                else {\r\n                    let parentNodeElement = this.getParentNodeElement(nodeElement);\r\n                    if (parentNodeElement) {\r\n                        this.focusNode(parentNodeElement);\r\n                    }\r\n                }\r\n\r\n                event.preventDefault();\r\n            break;\r\n\r\n            //right arrow\r\n            case 39:\r\n                if (!this.node.expanded) {\r\n                    this.expand(event);\r\n                }\r\n\r\n                event.preventDefault();\r\n            break;\r\n\r\n            //left arrow\r\n            case 37:\r\n                if (this.node.expanded) {\r\n                    this.collapse(event);\r\n                }\r\n                else {\r\n                    let parentNodeElement = this.getParentNodeElement(nodeElement);\r\n                    if (parentNodeElement) {\r\n                        this.focusNode(parentNodeElement);\r\n                    }\r\n                }\r\n\r\n                event.preventDefault();\r\n            break;\r\n\r\n            //enter\r\n            case 13:\r\n                this.tree.onNodeClick(event, this.node);\r\n                event.preventDefault();\r\n            break;\r\n\r\n            default:\r\n                //no op\r\n            break;\r\n        }\r\n    }\r\n\r\n    findNextSiblingOfAncestor(nodeElement) {\r\n        let parentNodeElement = this.getParentNodeElement(nodeElement);\r\n        if (parentNodeElement) {\r\n            if (parentNodeElement.nextElementSibling)\r\n                return parentNodeElement.nextElementSibling;\r\n            else\r\n                return this.findNextSiblingOfAncestor(parentNodeElement);\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    findLastVisibleDescendant(nodeElement) {\r\n        const childrenListElement = nodeElement.children[0].children[1];\r\n        if (childrenListElement && childrenListElement.children.length > 0) {\r\n            const lastChildElement = childrenListElement.children[childrenListElement.children.length - 1];\r\n\r\n            return this.findLastVisibleDescendant(lastChildElement);\r\n        }\r\n        else {\r\n            return nodeElement;\r\n        }\r\n    }\r\n\r\n    getParentNodeElement(nodeElement) {\r\n        const parentNodeElement = nodeElement.parentElement.parentElement.parentElement;\r\n\r\n        return parentNodeElement.tagName === 'P-TREENODE' ? parentNodeElement : null;\r\n    }\r\n\r\n    focusNode(element) {\r\n        if (this.tree.droppableNodes)\r\n            element.children[1].children[0].focus();\r\n        else\r\n            element.children[0].children[0].focus();\r\n    }\r\n}\r\n\r\n@Component({\r\n    selector: 'p-tree',\r\n    template: `\r\n        <div [ngClass]=\"{'ui-tree ui-widget ui-widget-content ui-corner-all':true,'ui-tree-selectable':selectionMode,'ui-treenode-dragover':dragHover,'ui-tree-loading': loading}\" [ngStyle]=\"style\" [class]=\"styleClass\" *ngIf=\"!horizontal\"\r\n            (drop)=\"onDrop($event)\" (dragover)=\"onDragOver($event)\" (dragenter)=\"onDragEnter($event)\" (dragleave)=\"onDragLeave($event)\">\r\n            <div class=\"ui-tree-loading-mask ui-widget-overlay\" *ngIf=\"loading\"></div>\r\n            <div class=\"ui-tree-loading-content\" *ngIf=\"loading\">\r\n                <i [class]=\"'ui-tree-loading-icon pi-spin ' + loadingIcon\"></i>\r\n            </div>\r\n            <div *ngIf=\"filter\" class=\"ui-tree-filter-container\">\r\n                <input #filter type=\"text\" autocomplete=\"off\" class=\"ui-tree-filter ui-inputtext ui-widget ui-state-default ui-corner-all\" [attr.placeholder]=\"filterPlaceholder\"\r\n                    (keydown.enter)=\"$event.preventDefault()\" (input)=\"onFilter($event)\">\r\n                    <span class=\"ui-tree-filter-icon pi pi-search\"></span>\r\n            </div>\r\n            <ul class=\"ui-tree-container\" *ngIf=\"getRootNode()\" role=\"tree\" [attr.aria-label]=\"ariaLabel\" [attr.aria-labelledby]=\"ariaLabelledBy\">\r\n                <p-treeNode *ngFor=\"let node of getRootNode(); let firstChild=first;let lastChild=last; let index=index; trackBy: nodeTrackBy\" [node]=\"node\"\r\n                [firstChild]=\"firstChild\" [lastChild]=\"lastChild\" [index]=\"index\"></p-treeNode>\r\n            </ul>\r\n            <div class=\"ui-tree-empty-message\" *ngIf=\"!loading && (value == null || value.length === 0)\">{{emptyMessage}}</div>\r\n        </div>\r\n        <div [ngClass]=\"{'ui-tree ui-tree-horizontal ui-widget ui-widget-content ui-corner-all':true,'ui-tree-selectable':selectionMode}\"  [ngStyle]=\"style\" [class]=\"styleClass\" *ngIf=\"horizontal\">\r\n            <div class=\"ui-tree-loading ui-widget-overlay\" *ngIf=\"loading\"></div>\r\n            <div class=\"ui-tree-loading-content\" *ngIf=\"loading\">\r\n                <i [class]=\"'ui-tree-loading-icon pi-spin ' + loadingIcon\"></i>\r\n            </div>\r\n            <table *ngIf=\"value&&value[0]\">\r\n                <p-treeNode [node]=\"value[0]\" [root]=\"true\"></p-treeNode>\r\n            </table>\r\n            <div class=\"ui-tree-empty-message\" *ngIf=\"!loading && (value == null || value.length === 0)\">{{emptyMessage}}</div>\r\n        </div>\r\n    `,\r\n    changeDetection: ChangeDetectionStrategy.Default\r\n})\r\nexport class Tree implements OnInit,AfterContentInit,OnDestroy,BlockableUI {\r\n\r\n    @Input() value: TreeNode[];\r\n\r\n    @Input() selectionMode: string;\r\n\r\n    @Input() selection: any;\r\n\r\n    @Output() selectionChange: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Output() onNodeSelect: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Output() onNodeUnselect: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Output() onNodeExpand: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Output() onNodeCollapse: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Output() onNodeContextMenuSelect: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Output() onNodeDrop: EventEmitter<any> = new EventEmitter();\r\n\r\n    @Input() style: any;\r\n\r\n    @Input() styleClass: string;\r\n\r\n    @Input() contextMenu: any;\r\n\r\n    @Input() layout: string = 'vertical';\r\n\r\n    @Input() draggableScope: any;\r\n\r\n    @Input() droppableScope: any;\r\n\r\n    @Input() draggableNodes: boolean;\r\n\r\n    @Input() droppableNodes: boolean;\r\n\r\n    @Input() metaKeySelection: boolean = true;\r\n\r\n    @Input() propagateSelectionUp: boolean = true;\r\n\r\n    @Input() propagateSelectionDown: boolean = true;\r\n\r\n    @Input() loading: boolean;\r\n\r\n    @Input() loadingIcon: string = 'pi pi-spinner';\r\n\r\n    @Input() emptyMessage: string = 'No records found';\r\n\r\n    @Input() ariaLabel: string;\r\n\r\n    @Input() ariaLabelledBy: string;\r\n\r\n    @Input() validateDrop: boolean;\r\n\r\n    @Input() filter: boolean;\r\n\r\n    @Input() filterBy: string = 'label';\r\n\r\n    @Input() filterMode: string = 'lenient';\r\n\r\n    @Input() filterPlaceholder: string;\r\n\r\n    @Input() filterLocale: string;\r\n\r\n    @Input() nodeTrackBy: Function = (index: number, item: any) => item;\r\n\r\n    @ContentChildren(PrimeTemplate) templates: QueryList<any>;\r\n\r\n    public templateMap: any;\r\n\r\n    public nodeTouched: boolean;\r\n\r\n    public dragNodeTree: Tree;\r\n\r\n    public dragNode: TreeNode;\r\n\r\n    public dragNodeSubNodes: TreeNode[];\r\n\r\n    public dragNodeIndex: number;\r\n\r\n    public dragNodeScope: any;\r\n\r\n    public dragHover: boolean;\r\n\r\n    public dragStartSubscription: Subscription;\r\n\r\n    public dragStopSubscription: Subscription;\r\n\r\n    public filteredNodes: TreeNode[];\r\n\r\n    constructor(public el: ElementRef, @Optional() public dragDropService: TreeDragDropService) {}\r\n\r\n    ngOnInit() {\r\n        if (this.droppableNodes) {\r\n            this.dragStartSubscription = this.dragDropService.dragStart$.subscribe(\r\n              event => {\r\n                this.dragNodeTree = event.tree;\r\n                this.dragNode = event.node;\r\n                this.dragNodeSubNodes = event.subNodes;\r\n                this.dragNodeIndex = event.index;\r\n                this.dragNodeScope = event.scope;\r\n            });\r\n\r\n            this.dragStopSubscription = this.dragDropService.dragStop$.subscribe(\r\n              event => {\r\n                this.dragNodeTree = null;\r\n                this.dragNode = null;\r\n                this.dragNodeSubNodes = null;\r\n                this.dragNodeIndex = null;\r\n                this.dragNodeScope = null;\r\n                this.dragHover = false;\r\n            });\r\n        }\r\n    }\r\n\r\n    get horizontal(): boolean {\r\n        return this.layout == 'horizontal';\r\n    }\r\n\r\n    ngAfterContentInit() {\r\n        if (this.templates.length) {\r\n            this.templateMap = {};\r\n        }\r\n\r\n        this.templates.forEach((item) => {\r\n            this.templateMap[item.name] = item.template;\r\n        });\r\n    }\r\n\r\n    onNodeClick(event, node: TreeNode) {\r\n        let eventTarget = (<Element> event.target);\r\n\r\n        if (DomHandler.hasClass(eventTarget, 'ui-tree-toggler')) {\r\n            return;\r\n        }\r\n        else if (this.selectionMode) {\r\n            if (node.selectable === false) {\r\n                return;\r\n            }\r\n\r\n            if (this.hasFilteredNodes()) {\r\n                node = this.getNodeWithKey(node.key, this.value);\r\n\r\n                if (!node) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let index = this.findIndexInSelection(node);\r\n            let selected = (index >= 0);\r\n\r\n            if (this.isCheckboxSelectionMode()) {\r\n                if (selected) {\r\n                    if (this.propagateSelectionDown)\r\n                        this.propagateDown(node, false);\r\n                    else\r\n                        this.selection = this.selection.filter((val,i) => i!=index);\r\n\r\n                    if (this.propagateSelectionUp && node.parent) {\r\n                        this.propagateUp(node.parent, false);\r\n                    }\r\n\r\n                    this.selectionChange.emit(this.selection);\r\n                    this.onNodeUnselect.emit({originalEvent: event, node: node});\r\n                }\r\n                else {\r\n                    if (this.propagateSelectionDown)\r\n                        this.propagateDown(node, true);\r\n                    else\r\n                        this.selection = [...this.selection||[],node];\r\n\r\n                    if (this.propagateSelectionUp && node.parent) {\r\n                        this.propagateUp(node.parent, true);\r\n                    }\r\n\r\n                    this.selectionChange.emit(this.selection);\r\n                    this.onNodeSelect.emit({originalEvent: event, node: node});\r\n                }\r\n            }\r\n            else {\r\n                let metaSelection = this.nodeTouched ? false : this.metaKeySelection;\r\n\r\n                if (metaSelection) {\r\n                    let metaKey = (event.metaKey||event.ctrlKey);\r\n\r\n                    if (selected && metaKey) {\r\n                        if (this.isSingleSelectionMode()) {\r\n                            this.selectionChange.emit(null);\r\n                        }\r\n                        else {\r\n                            this.selection = this.selection.filter((val,i) => i!=index);\r\n                            this.selectionChange.emit(this.selection);\r\n                        }\r\n\r\n                        this.onNodeUnselect.emit({originalEvent: event, node: node});\r\n                    }\r\n                    else {\r\n                        if (this.isSingleSelectionMode()) {\r\n                            this.selectionChange.emit(node);\r\n                        }\r\n                        else if (this.isMultipleSelectionMode()) {\r\n                            this.selection = (!metaKey) ? [] : this.selection||[];\r\n                            this.selection = [...this.selection,node];\r\n                            this.selectionChange.emit(this.selection);\r\n                        }\r\n\r\n                        this.onNodeSelect.emit({originalEvent: event, node: node});\r\n                    }\r\n                }\r\n                else {\r\n                    if (this.isSingleSelectionMode()) {\r\n                        if (selected) {\r\n                            this.selection = null;\r\n                            this.onNodeUnselect.emit({originalEvent: event, node: node});\r\n                        }\r\n                        else {\r\n                            this.selection = node;\r\n                            this.onNodeSelect.emit({originalEvent: event, node: node});\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (selected) {\r\n                            this.selection = this.selection.filter((val,i) => i!=index);\r\n                            this.onNodeUnselect.emit({originalEvent: event, node: node});\r\n                        }\r\n                        else {\r\n                            this.selection = [...this.selection||[],node];\r\n                            this.onNodeSelect.emit({originalEvent: event, node: node});\r\n                        }\r\n                    }\r\n\r\n                    this.selectionChange.emit(this.selection);\r\n                }\r\n            }\r\n        }\r\n\r\n        this.nodeTouched = false;\r\n    }\r\n\r\n    onNodeTouchEnd() {\r\n        this.nodeTouched = true;\r\n    }\r\n\r\n    onNodeRightClick(event: MouseEvent, node: TreeNode) {\r\n        if (this.contextMenu) {\r\n            let eventTarget = (<Element> event.target);\r\n\r\n            if (eventTarget.className && eventTarget.className.indexOf('ui-tree-toggler') === 0) {\r\n                return;\r\n            }\r\n            else {\r\n                let index = this.findIndexInSelection(node);\r\n                let selected = (index >= 0);\r\n\r\n                if (!selected) {\r\n                    if (this.isSingleSelectionMode())\r\n                        this.selectionChange.emit(node);\r\n                    else\r\n                        this.selectionChange.emit([node]);\r\n                }\r\n\r\n                this.contextMenu.show(event);\r\n                this.onNodeContextMenuSelect.emit({originalEvent: event, node: node});\r\n            }\r\n        }\r\n    }\r\n\r\n    findIndexInSelection(node: TreeNode) {\r\n        let index: number = -1;\r\n\r\n        if (this.selectionMode && this.selection) {\r\n            if (this.isSingleSelectionMode()) {\r\n                let areNodesEqual = (this.selection.key && this.selection.key === node.key) || this.selection == node;\r\n                index = areNodesEqual ? 0 : - 1;\r\n            }\r\n            else {\r\n                for(let i = 0; i  < this.selection.length; i++) {\r\n                    let selectedNode = this.selection[i];\r\n                    let areNodesEqual = (selectedNode.key && selectedNode.key === node.key) || selectedNode == node;\r\n                    if (areNodesEqual) {\r\n                        index = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    syncNodeOption(node, parentNodes, option, value?: any) {\r\n        // to synchronize the node option between the filtered nodes and the original nodes(this.value)\r\n        const _node = this.hasFilteredNodes() ? this.getNodeWithKey(node.key, parentNodes) : null;\r\n        if (_node) {\r\n            _node[option] = value||node[option];\r\n        }\r\n    }\r\n\r\n    hasFilteredNodes() {\r\n        return this.filter && this.filteredNodes && this.filteredNodes.length;\r\n    }\r\n\r\n    getNodeWithKey(key: string, nodes: TreeNode[]) {\r\n        for (let node of nodes) {\r\n            if (node.key === key) {\r\n                return node;\r\n            }\r\n\r\n            if (node.children) {\r\n                let matchedNode = this.getNodeWithKey(key, node.children);\r\n                if (matchedNode) {\r\n                    return matchedNode;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    propagateUp(node: TreeNode, select: boolean) {\r\n        if (node.children && node.children.length) {\r\n            let selectedCount: number = 0;\r\n            let childPartialSelected: boolean = false;\r\n            for(let child of node.children) {\r\n                if (this.isSelected(child)) {\r\n                    selectedCount++;\r\n                }\r\n                else if (child.partialSelected) {\r\n                    childPartialSelected = true;\r\n                }\r\n            }\r\n\r\n            if (select && selectedCount == node.children.length) {\r\n                this.selection = [...this.selection||[],node];\r\n                node.partialSelected = false;\r\n            }\r\n            else {\r\n                if (!select) {\r\n                    let index = this.findIndexInSelection(node);\r\n                    if (index >= 0) {\r\n                        this.selection = this.selection.filter((val,i) => i!=index);\r\n                    }\r\n                }\r\n\r\n                if (childPartialSelected || selectedCount > 0 && selectedCount != node.children.length)\r\n                    node.partialSelected = true;\r\n                else\r\n                    node.partialSelected = false;\r\n            }\r\n\r\n            this.syncNodeOption(node, this.filteredNodes, 'partialSelected');\r\n        }\r\n\r\n        let parent = node.parent;\r\n        if (parent) {\r\n            this.propagateUp(parent, select);\r\n        }\r\n    }\r\n\r\n    propagateDown(node: TreeNode, select: boolean) {\r\n        let index = this.findIndexInSelection(node);\r\n\r\n        if (select && index == -1) {\r\n            this.selection = [...this.selection||[],node];\r\n        }\r\n        else if (!select && index > -1) {\r\n            this.selection = this.selection.filter((val,i) => i!=index);\r\n        }\r\n\r\n        node.partialSelected = false;\r\n\r\n        this.syncNodeOption(node, this.filteredNodes, 'partialSelected');\r\n\r\n        if (node.children && node.children.length) {\r\n            for(let child of node.children) {\r\n                this.propagateDown(child, select);\r\n            }\r\n        }\r\n    }\r\n\r\n    isSelected(node: TreeNode) {\r\n        return this.findIndexInSelection(node) != -1;\r\n    }\r\n\r\n    isSingleSelectionMode() {\r\n        return this.selectionMode && this.selectionMode == 'single';\r\n    }\r\n\r\n    isMultipleSelectionMode() {\r\n        return this.selectionMode && this.selectionMode == 'multiple';\r\n    }\r\n\r\n    isCheckboxSelectionMode() {\r\n        return this.selectionMode && this.selectionMode == 'checkbox';\r\n    }\r\n\r\n    isNodeLeaf(node) {\r\n        return node.leaf == false ? false : !(node.children && node.children.length);\r\n    }\r\n\r\n    getRootNode() {\r\n        return this.filteredNodes ? this.filteredNodes : this.value;\r\n    }\r\n\r\n    getTemplateForNode(node: TreeNode): TemplateRef<any> {\r\n        if (this.templateMap)\r\n            return node.type ? this.templateMap[node.type] : this.templateMap['default'];\r\n        else\r\n            return null;\r\n    }\r\n\r\n    onDragOver(event) {\r\n        if (this.droppableNodes && (!this.value || this.value.length === 0)) {\r\n            event.dataTransfer.dropEffect = 'move';\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    onDrop(event) {\r\n        if (this.droppableNodes && (!this.value || this.value.length === 0)) {\r\n            event.preventDefault();\r\n            let dragNode = this.dragNode;\r\n            if (this.allowDrop(dragNode, null, this.dragNodeScope)) {\r\n                let dragNodeIndex = this.dragNodeIndex;\r\n                this.dragNodeSubNodes.splice(dragNodeIndex, 1);\r\n                this.value = this.value||[];\r\n                this.value.push(dragNode);\r\n\r\n                this.dragDropService.stopDrag({\r\n                    node: dragNode\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    onDragEnter(event) {\r\n        if (this.droppableNodes && this.allowDrop(this.dragNode, null, this.dragNodeScope)) {\r\n            this.dragHover = true;\r\n        }\r\n    }\r\n\r\n    onDragLeave(event) {\r\n        if (this.droppableNodes) {\r\n            let rect = event.currentTarget.getBoundingClientRect();\r\n            if (event.x > rect.left + rect.width || event.x < rect.left || event.y > rect.top + rect.height || event.y < rect.top) {\r\n               this.dragHover = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    allowDrop(dragNode: TreeNode, dropNode: TreeNode, dragNodeScope: any): boolean {\r\n        if (!dragNode) {\r\n            //prevent random html elements to be dragged\r\n            return false;\r\n        }\r\n        else if (this.isValidDragScope(dragNodeScope)) {\r\n            let allow: boolean = true;\r\n            if (dropNode) {\r\n                if (dragNode === dropNode) {\r\n                    allow = false;\r\n                }\r\n                else {\r\n                    let parent = dropNode.parent;\r\n                    while(parent != null) {\r\n                        if (parent === dragNode) {\r\n                            allow = false;\r\n                            break;\r\n                        }\r\n                        parent = parent.parent;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return allow;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    isValidDragScope(dragScope: any): boolean {\r\n        let dropScope = this.droppableScope;\r\n\r\n        if (dropScope) {\r\n            if (typeof dropScope === 'string') {\r\n                if (typeof dragScope === 'string')\r\n                    return dropScope === dragScope;\r\n                else if (dragScope instanceof Array)\r\n                    return (<Array<any>>dragScope).indexOf(dropScope) != -1;\r\n            }\r\n            else if (dropScope instanceof Array) {\r\n                if (typeof dragScope === 'string') {\r\n                    return (<Array<any>>dropScope).indexOf(dragScope) != -1;\r\n                }\r\n                else if (dragScope instanceof Array) {\r\n                    for(let s of dropScope) {\r\n                        for(let ds of dragScope) {\r\n                            if (s === ds) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    onFilter(event) {\r\n        let filterValue = event.target.value;\r\n        if (filterValue === '') {\r\n            this.filteredNodes = null;\r\n        }\r\n        else {\r\n            this.filteredNodes = [];\r\n            const searchFields: string[] = this.filterBy.split(',');\r\n            const filterText = ObjectUtils.removeAccents(filterValue).toLocaleLowerCase(this.filterLocale);\r\n            const isStrictMode = this.filterMode === 'strict';\r\n            for(let node of this.value) {\r\n                let copyNode = {...node};\r\n                let paramsWithoutNode = {searchFields, filterText, isStrictMode};\r\n                if ((isStrictMode && (this.findFilteredNodes(copyNode, paramsWithoutNode) || this.isFilterMatched(copyNode, paramsWithoutNode))) ||\r\n                    (!isStrictMode && (this.isFilterMatched(copyNode, paramsWithoutNode) || this.findFilteredNodes(copyNode, paramsWithoutNode)))) {\r\n                    this.filteredNodes.push(copyNode);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    findFilteredNodes(node, paramsWithoutNode) {\r\n        if (node) {\r\n            let matched = false;\r\n            if (node.children) {\r\n                let childNodes = [...node.children];\r\n                node.children = [];\r\n                for (let childNode of childNodes) {\r\n                    let copyChildNode = {...childNode};\r\n                    if (this.isFilterMatched(copyChildNode, paramsWithoutNode)) {\r\n                        matched = true;\r\n                        node.children.push(copyChildNode);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (matched) {\r\n                node.expanded = true;\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n\r\n    isFilterMatched(node, {searchFields, filterText, isStrictMode}) {\r\n        let matched = false;\r\n        for(let field of searchFields) {\r\n            let fieldValue = ObjectUtils.removeAccents(String(ObjectUtils.resolveFieldData(node, field))).toLocaleLowerCase(this.filterLocale);\r\n            if (fieldValue.indexOf(filterText) > -1) {\r\n                matched = true;\r\n            }\r\n        }\r\n\r\n        if (!matched || (isStrictMode && !this.isNodeLeaf(node))) {\r\n            matched = this.findFilteredNodes(node, {searchFields, filterText, isStrictMode}) || matched;\r\n        }\r\n\r\n        return matched;\r\n    }\r\n\r\n    getBlockableElement(): HTMLElement{\r\n      return this.el.nativeElement.children[0];\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.dragStartSubscription) {\r\n            this.dragStartSubscription.unsubscribe();\r\n        }\r\n\r\n        if (this.dragStopSubscription) {\r\n            this.dragStopSubscription.unsubscribe();\r\n        }\r\n    }\r\n}\r\n@NgModule({\r\n    imports: [CommonModule],\r\n    exports: [Tree,SharedModule],\r\n    declarations: [Tree,UITreeNode]\r\n})\r\nexport class TreeModule { }\r\n"]}