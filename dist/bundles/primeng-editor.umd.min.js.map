{"version":3,"sources":["ng://primeng/editor/editor.ts"],"names":["EDITOR_VALUE_ACCESSOR","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","Editor","multi","el","this","onTextChange","EventEmitter","onSelectionChange","onInit","onModelChange","onModelTouched","prototype","ngAfterViewInit","_this","editorElement","DomHandler","findSingle","nativeElement","defaultModule","toolbar","modules","__assign","quill","Quill","placeholder","readOnly","readonly","theme","formats","bounds","debug","scrollingContainer","value","pasteHTML","on","delta","oldContents","source","html","children","innerHTML","text","getText","trim","emit","htmlValue","textValue","range","oldRange","editor","writeValue","setText","registerOnChange","fn","registerOnTouched","getQuill","Object","defineProperty","_readonly","val","disable","enable","ElementRef","__decorate","Output","ContentChild","Header","Input","Component","selector","template","providers","changeDetection","ChangeDetectionStrategy","Default","EditorModule","NgModule","imports","CommonModule","exports","SharedModule","declarations"],"mappings":"inCAOaA,EAA6B,CACxCC,QAASC,EAAAA,kBACTC,YAAaC,EAAAA,YAAW,WAAM,OAAAC,KAC9BC,OAAO,GAyDTD,EAAA,WAoCI,SAAAA,EAAmBE,GAAAC,KAAAD,GAAAA,EAlCTC,KAAAC,aAAkC,IAAIC,EAAAA,aAEtCF,KAAAG,kBAAuC,IAAID,EAAAA,aAoB3CF,KAAAI,OAA4B,IAAIF,EAAAA,aAM1CF,KAAAK,cAA0B,aAE1BL,KAAAM,eAA2B,aAiG/B,OA3FIT,EAAAU,UAAAC,gBAAA,WAAA,IAAAC,EAAAT,KACQU,EAAgBC,EAAAA,WAAWC,WAAWZ,KAAKD,GAAGc,cAAe,yBAE7DC,EAAiB,CAACC,QADDJ,EAAAA,WAAWC,WAAWZ,KAAKD,GAAGc,cAAe,0BAE9DG,EAAUhB,KAAKgB,QAAOC,EAAAA,EAAA,GAAOH,GAAkBd,KAAKgB,SAAWF,EAEnEd,KAAKkB,MAAQ,IAAIC,EAAMT,EAAe,CACpCM,QAASA,EACTI,YAAapB,KAAKoB,YAClBC,SAAUrB,KAAKsB,SACfC,MAAO,OACPC,QAASxB,KAAKwB,QACdC,OAAQzB,KAAKyB,OACbC,MAAO1B,KAAK0B,MACZC,mBAAoB3B,KAAK2B,qBAGvB3B,KAAK4B,OACL5B,KAAKkB,MAAMW,UAAU7B,KAAK4B,OAG9B5B,KAAKkB,MAAMY,GAAG,eAAe,SAACC,EAAOC,EAAaC,GAC9C,GAAe,SAAXA,EAAmB,CACnB,IAAIC,EAAOxB,EAAcyB,SAAS,GAAGC,UACjCC,EAAO5B,EAAKS,MAAMoB,UAAUC,OACnB,gBAATL,IACAA,EAAO,MAGXzB,EAAKR,aAAauC,KAAK,CACnBC,UAAWP,EACXQ,UAAWL,EACXN,MAAOA,EACPE,OAAQA,IAGZxB,EAAKJ,cAAc6B,GACnBzB,EAAKH,qBAIbN,KAAKkB,MAAMY,GAAG,oBAAoB,SAACa,EAAOC,EAAUX,GAChDxB,EAAKN,kBAAkBqC,KAAK,CACxBG,MAAOA,EACPC,SAAUA,EACVX,OAAQA,OAIhBjC,KAAKI,OAAOoC,KAAK,CACbK,OAAQ7C,KAAKkB,SAIrBrB,EAAAU,UAAAuC,WAAA,SAAWlB,GACP5B,KAAK4B,MAAQA,EAET5B,KAAKkB,QACDU,EACA5B,KAAKkB,MAAMW,UAAUD,GAErB5B,KAAKkB,MAAM6B,QAAQ,MAI/BlD,EAAAU,UAAAyC,iBAAA,SAAiBC,GACbjD,KAAKK,cAAgB4C,GAGzBpD,EAAAU,UAAA2C,kBAAA,SAAkBD,GACdjD,KAAKM,eAAiB2C,GAG1BpD,EAAAU,UAAA4C,SAAA,WACI,OAAOnD,KAAKkB,OAGPkC,OAAAC,eAAIxD,EAAAU,UAAA,WAAQ,KAAZ,WACL,OAAOP,KAAKsD,eAGhB,SAAaC,GACTvD,KAAKsD,UAAYC,EAEbvD,KAAKkB,QACDlB,KAAKsD,UACLtD,KAAKkB,MAAMsC,UAEXxD,KAAKkB,MAAMuC,oFA1FAC,EAAAA,cAlCbC,EAAA,CAATC,EAAAA,6CAESD,EAAA,CAATC,EAAAA,kDAEqBD,EAAA,CAArBE,EAAAA,aAAaC,EAAAA,uCAELH,EAAA,CAARI,EAAAA,qCAEQJ,EAAA,CAARI,EAAAA,0CAEQJ,EAAA,CAARI,EAAAA,2CAEQJ,EAAA,CAARI,EAAAA,uCAEQJ,EAAA,CAARI,EAAAA,uCAEQJ,EAAA,CAARI,EAAAA,sCAEQJ,EAAA,CAARI,EAAAA,kDAEQJ,EAAA,CAARI,EAAAA,qCAESJ,EAAA,CAATC,EAAAA,uCA2FQD,EAAA,CAARI,EAAAA,sCAnHQlE,EAAM8D,EAAA,CAtDlBK,EAAAA,UAAU,CACPC,SAAU,WACVC,SAAU,6hFAiDVC,UAAW,CAAC3E,GACZ4E,gBAAiBC,EAAAA,wBAAwBC,WAEhCzE,GAAb,gBAwIA,SAAA0E,KAA4B,OAAfA,EAAYZ,EAAA,CALxBa,EAAAA,SAAS,CACNC,QAAS,CAACC,EAAAA,cACVC,QAAS,CAAC9E,EAAO+E,EAAAA,cACjBC,aAAc,CAAChF,MAEN0E","sourcesContent":["import {NgModule,Component,ElementRef,AfterViewInit,Input,Output,EventEmitter,ContentChild,forwardRef,ChangeDetectionStrategy} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport {SharedModule,Header} from 'primeng/api'\r\nimport {DomHandler} from 'primeng/dom';\r\nimport {NG_VALUE_ACCESSOR, ControlValueAccessor} from '@angular/forms';\r\nimport * as Quill from \"quill\";\r\n\r\nexport const EDITOR_VALUE_ACCESSOR: any = {\r\n  provide: NG_VALUE_ACCESSOR,\r\n  useExisting: forwardRef(() => Editor),\r\n  multi: true\r\n};\r\n\r\n@Component({\r\n    selector: 'p-editor',\r\n    template: `\r\n        <div [ngClass]=\"'ui-widget ui-editor-container ui-corner-all'\" [class]=\"styleClass\">\r\n            <div class=\"ui-editor-toolbar ui-widget-header ui-corner-top\" *ngIf=\"toolbar\">\r\n                <ng-content select=\"p-header\"></ng-content>\r\n            </div>\r\n            <div class=\"ui-editor-toolbar ui-widget-header ui-corner-top\" *ngIf=\"!toolbar\">\r\n                <span class=\"ql-formats\">\r\n                    <select class=\"ql-header\">\r\n                      <option value=\"1\">Heading</option>\r\n                      <option value=\"2\">Subheading</option>\r\n                      <option selected>Normal</option>\r\n                    </select>\r\n                    <select class=\"ql-font\">\r\n                      <option selected>Sans Serif</option>\r\n                      <option value=\"serif\">Serif</option>\r\n                      <option value=\"monospace\">Monospace</option>\r\n                    </select>\r\n                </span>\r\n                <span class=\"ql-formats\">\r\n                    <button class=\"ql-bold\" aria-label=\"Bold\"></button>\r\n                    <button class=\"ql-italic\" aria-label=\"Italic\"></button>\r\n                    <button class=\"ql-underline\" aria-label=\"Underline\"></button>\r\n                </span>\r\n                <span class=\"ql-formats\">\r\n                    <select class=\"ql-color\"></select>\r\n                    <select class=\"ql-background\"></select>\r\n                </span>\r\n                <span class=\"ql-formats\">\r\n                    <button class=\"ql-list\" value=\"ordered\" aria-label=\"Ordered List\"></button>\r\n                    <button class=\"ql-list\" value=\"bullet\" aria-label=\"Unordered List\"></button>\r\n                    <select class=\"ql-align\">\r\n                        <option selected></option>\r\n                        <option value=\"center\"></option>\r\n                        <option value=\"right\"></option>\r\n                        <option value=\"justify\"></option>\r\n                    </select>\r\n                </span>\r\n                <span class=\"ql-formats\">\r\n                    <button class=\"ql-link\" aria-label=\"Insert Link\"></button>\r\n                    <button class=\"ql-image\" aria-label=\"Insert Image\"></button>\r\n                    <button class=\"ql-code-block\" aria-label=\"Insert Code Block\"></button>\r\n                </span>\r\n                <span class=\"ql-formats\">\r\n                    <button class=\"ql-clean\" aria-label=\"Remove Styles\"></button>\r\n                </span>\r\n            </div>\r\n            <div class=\"ui-editor-content\" [ngStyle]=\"style\"></div>\r\n        </div>\r\n    `,\r\n    providers: [EDITOR_VALUE_ACCESSOR],\r\n    changeDetection: ChangeDetectionStrategy.Default\r\n})\r\nexport class Editor implements AfterViewInit,ControlValueAccessor {\r\n        \r\n    @Output() onTextChange: EventEmitter<any> = new EventEmitter();\r\n    \r\n    @Output() onSelectionChange: EventEmitter<any> = new EventEmitter();\r\n    \r\n    @ContentChild(Header) toolbar;\r\n    \r\n    @Input() style: any;\r\n        \r\n    @Input() styleClass: string;\r\n    \r\n    @Input() placeholder: string;\r\n    \r\n    @Input() formats: string[];\r\n\r\n    @Input() modules: any;\r\n\r\n    @Input() bounds: any;\r\n\r\n    @Input() scrollingContainer: any;\r\n\r\n    @Input() debug: string;\r\n    \r\n    @Output() onInit: EventEmitter<any> = new EventEmitter();\r\n    \r\n    value: string;\r\n    \r\n    _readonly: boolean;\r\n    \r\n    onModelChange: Function = () => {};\r\n    \r\n    onModelTouched: Function = () => {};\r\n    \r\n    quill: any;\r\n    \r\n    constructor(public el: ElementRef) {}\r\n\r\n    ngAfterViewInit() {\r\n        let editorElement = DomHandler.findSingle(this.el.nativeElement ,'div.ui-editor-content'); \r\n        let toolbarElement = DomHandler.findSingle(this.el.nativeElement ,'div.ui-editor-toolbar'); \r\n        let defaultModule  = {toolbar: toolbarElement};\r\n        let modules = this.modules ? {...defaultModule, ...this.modules} : defaultModule;\r\n\r\n        this.quill = new Quill(editorElement, {\r\n          modules: modules,\r\n          placeholder: this.placeholder,\r\n          readOnly: this.readonly,\r\n          theme: 'snow',\r\n          formats: this.formats,\r\n          bounds: this.bounds,\r\n          debug: this.debug,\r\n          scrollingContainer: this.scrollingContainer\r\n        });\r\n                \r\n        if (this.value) {\r\n            this.quill.pasteHTML(this.value);\r\n        }\r\n        \r\n        this.quill.on('text-change', (delta, oldContents, source) => {\r\n            if (source === 'user') {\r\n                let html = editorElement.children[0].innerHTML;\r\n                let text = this.quill.getText().trim();\r\n                if (html === '<p><br></p>') {\r\n                    html = null;\r\n                }\r\n\r\n                this.onTextChange.emit({\r\n                    htmlValue: html,\r\n                    textValue: text,\r\n                    delta: delta,\r\n                    source: source\r\n                });\r\n                \r\n                this.onModelChange(html);\r\n                this.onModelTouched();\r\n            }\r\n        });\r\n        \r\n        this.quill.on('selection-change', (range, oldRange, source) => {\r\n            this.onSelectionChange.emit({\r\n                range: range,\r\n                oldRange: oldRange,\r\n                source: source\r\n            });\r\n        });\r\n        \r\n        this.onInit.emit({\r\n            editor: this.quill\r\n        });\r\n    }\r\n        \r\n    writeValue(value: any) : void {\r\n        this.value = value;\r\n                \r\n        if (this.quill) {\r\n            if (value)\r\n                this.quill.pasteHTML(value);\r\n            else\r\n                this.quill.setText('');\r\n        }\r\n    }\r\n    \r\n    registerOnChange(fn: Function): void {\r\n        this.onModelChange = fn;\r\n    }\r\n\r\n    registerOnTouched(fn: Function): void {\r\n        this.onModelTouched = fn;\r\n    }\r\n    \r\n    getQuill() {\r\n        return this.quill;\r\n    }\r\n    \r\n    @Input() get readonly(): boolean {\r\n        return this._readonly;\r\n    }\r\n\r\n    set readonly(val:boolean) {\r\n        this._readonly = val;\r\n        \r\n        if (this.quill) {\r\n            if (this._readonly)\r\n                this.quill.disable();\r\n            else\r\n                this.quill.enable();\r\n        }\r\n    }\r\n}\r\n\r\n@NgModule({\r\n    imports: [CommonModule],\r\n    exports: [Editor,SharedModule],\r\n    declarations: [Editor]\r\n})\r\nexport class EditorModule { }\r\n"]}